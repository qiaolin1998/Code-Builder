<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<RSLogix5000Content SchemaRevision="1.0" SoftwareRevision="36.00" TargetName="Test" TargetType="Routine" TargetSubType="ST" ContainsContext="true" ExportDate="Sat Jan 31 16:33:39 2026" ExportOptions="References NoRawData L5KData DecoratedData Context Dependencies ForceProtectedEncoding AllProjDocTrans">
<Controller Use="Context" Name="Tot">
<Programs Use="Context">
<Program Use="Context" Name="MainProgram">
<Routines Use="Context">
<Routine Use="Target" Name="Test" Type="ST">
<STContent OnlineEditType="Original">
<Line Number="0">
<![CDATA[]]>
</Line>
</STContent>
<STContent OnlineEditType="PendingEdits">
<Line Number="0">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="1">
<![CDATA[// AOI 名称: FlowMeter_Tot (流量计累计量统计)]]>
</Line>
<Line Number="2">
<![CDATA[// 版本: 1.0]]>
</Line>
<Line Number="3">
<![CDATA[// 编程语言: Structured Text (ST)]]>
</Line>
<Line Number="4">
<![CDATA[// 适用平台: Studio 5000 (ControlLogix/CompactLogix)]]>
</Line>
<Line Number="5">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="6">
<![CDATA[// 功能概述:]]>
</Line>
<Line Number="7">
<![CDATA[// 本程序实现一个多维度的流量计累计量统计系统,支持以下时间维度的累计:]]>
</Line>
<Line Number="8">
<![CDATA[// 1. 总累计 - 从系统启动开始的累计值]]>
</Line>
<Line Number="9">
<![CDATA[// 2. 白班累计 - 09:00 - 21:00 的累计值]]>
</Line>
<Line Number="10">
<![CDATA[// 3. 夜班累计 - 21:00 - 次日 09:00 的累计值]]>
</Line>
<Line Number="11">
<![CDATA[// 4. 3小时区间累计 - 每3小时的累计值]]>
</Line>
<Line Number="12">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="13">
<![CDATA[// 核心设计理念:]]>
</Line>
<Line Number="14">
<![CDATA[// 1. 实时累计与历史累计分离: 实时累计值随时间变化,历史累计值在切换时刻冻结]]>
</Line>
<Line Number="15">
<![CDATA[// 2. 自动切换: 根据系统时间自动判断当前时间段,切换累计维度]]>
</Line>
<Line Number="16">
<![CDATA[// 3. 数据持久化: 历史累计值在切换时刻保存,不会丢失]]>
</Line>
<Line Number="17">
<![CDATA[// 4. 可配置性: 班次时间、累计周期等参数可通过输入参数配置]]>
</Line>
<Line Number="18">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="19">
<![CDATA[// 变量命名规范:]]>
</Line>
<Line Number="20">
<![CDATA[// - 输入参数: In_xxx (如 In_Flow, In_Run)]]>
</Line>
<Line Number="21">
<![CDATA[// - 输出参数: Out_xxx (如 Out_Tot, Out_Tot_Class1)]]>
</Line>
<Line Number="22">
<![CDATA[// - 实时累计: xxx_RT (如 Out_Tot_Class_RT, Out_Tot_3H_RT)]]>
</Line>
<Line Number="23">
<![CDATA[// - 临时变量: Temp[索引] (如 Temp[0], Temp[1])]]>
</Line>
<Line Number="24">
<![CDATA[// - 时间设置: Time_Setxxx (如 Time_Set1, Time_Set2)]]>
</Line>
<Line Number="25">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="26">
<![CDATA[]]>
</Line>
<Line Number="27">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="28">
<![CDATA[// 功能段 1: 流量检测与总累计]]>
</Line>
<Line Number="29">
<![CDATA[// 执行频率: 每次扫描]]>
</Line>
<Line Number="30">
<![CDATA[// 说明: 检测输入流量值的变化,并进行总累计计数]]>
</Line>
<Line Number="31">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="32">
<![CDATA[// 流量值处理]]>
</Line>
<Line Number="33">
<![CDATA[// 说明: 直接使用输入的流量累计值,无需上升沿检测]]>
</Line>
<Line Number="34">
<![CDATA[// 因为流量计通常直接输出累计值而非脉冲信号]]>
</Line>
<Line Number="35">
<![CDATA[IF In_Run THEN]]>
</Line>
<Line Number="36">
<![CDATA[    // 总累计值直接使用输入的流量累计值]]>
</Line>
<Line Number="37">
<![CDATA[    Out_Tot := In_Flow;]]>
</Line>
<Line Number="38">
<![CDATA[END_IF;]]>
</Line>
<Line Number="39">
<![CDATA[]]>
</Line>
<Line Number="40">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="41">
<![CDATA[// 功能段 2: 时间数据准备]]>
</Line>
<Line Number="42">
<![CDATA[// 执行频率: 每次扫描]]>
</Line>
<Line Number="43">
<![CDATA[// 说明: 读取系统时间,计算时间偏移量和时间设置]]>
</Line>
<Line Number="44">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="45">
<![CDATA[// 读取系统时间到时间数组]]>
</Line>
<Line Number="46">
<![CDATA[// Time[0] = 年份 (如: 2024)]]>
</Line>
<Line Number="47">
<![CDATA[// Time[1] = 月份 (1-12)]]>
</Line>
<Line Number="48">
<![CDATA[// Time[2] = 日期 (1-31)]]>
</Line>
<Line Number="49">
<![CDATA[// Time[3] = 小时 (0-23)]]>
</Line>
<Line Number="50">
<![CDATA[// Time[4] = 分钟 (0-59)]]>
</Line>
<Line Number="51">
<![CDATA[// Time[5] = 秒 (0-59)]]>
</Line>
<Line Number="52">
<![CDATA[Time[0] := Year;]]>
</Line>
<Line Number="53">
<![CDATA[Time[1] := Month;]]>
</Line>
<Line Number="54">
<![CDATA[Time[2] := Day;]]>
</Line>
<Line Number="55">
<![CDATA[Time[3] := Hour;]]>
</Line>
<Line Number="56">
<![CDATA[Time[4] := Minute;]]>
</Line>
<Line Number="57">
<![CDATA[Time[5] := Second;]]>
</Line>
<Line Number="58">
<![CDATA[]]>
</Line>
<Line Number="59">
<![CDATA[// 计算当前时间的分钟偏移量]]>
</Line>
<Line Number="60">
<![CDATA[// 公式: 小时 * 60 + 分钟]]>
</Line>
<Line Number="61">
<![CDATA[// 例如: 09:30 = 9 * 60 + 30 = 570 分钟]]>
</Line>
<Line Number="62">
<![CDATA[// 用途: 用于比较当前时间是否在某个时间段内]]>
</Line>
<Line Number="63">
<![CDATA[Time_Real := Hour * 60 + Minute;]]>
</Line>
<Line Number="64">
<![CDATA[]]>
</Line>
<Line Number="65">
<![CDATA[// 计算班次切换时间的分钟偏移量]]>
</Line>
<Line Number="66">
<![CDATA[// Time_Set1: 白班开始时间 (09:00 = 540 分钟)]]>
</Line>
<Line Number="67">
<![CDATA[// Time_Set2: 夜班开始时间 (21:00 = 1260 分钟)]]>
</Line>
<Line Number="68">
<![CDATA[Time_Set1 := 9 * 60 + 0;  // 09:00]]>
</Line>
<Line Number="69">
<![CDATA[Time_Set2 := 21 * 60 + 0; // 21:00]]>
</Line>
<Line Number="70">
<![CDATA[]]>
</Line>
<Line Number="71">
<![CDATA[// 计算3小时区间索引]]>
</Line>
<Line Number="72">
<![CDATA[// 0: 00:00-03:00, 1: 03:00-06:00, 2: 06:00-09:00]]>
</Line>
<Line Number="73">
<![CDATA[// 3: 09:00-12:00, 4: 12:00-15:00, 5: 15:00-18:00]]>
</Line>
<Line Number="74">
<![CDATA[// 6: 18:00-21:00, 7: 21:00-24:00]]>
</Line>
<Line Number="75">
<![CDATA[Hour_Index := Hour / 3;]]>
</Line>
<Line Number="76">
<![CDATA[]]>
</Line>
<Line Number="77">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="78">
<![CDATA[// 功能段 3: 白班累计逻辑]]>
</Line>
<Line Number="79">
<![CDATA[// 执行频率: 每次扫描]]>
</Line>
<Line Number="80">
<![CDATA[// 说明: 在白班时间段内进行累计计数]]>
</Line>
<Line Number="81">
<![CDATA[// 时间段: 09:00 - 21:00]]>
</Line>
<Line Number="82">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="83">
<![CDATA[// 白班累计计数]]>
</Line>
<Line Number="84">
<![CDATA[// 条件:]]>
</Line>
<Line Number="85">
<![CDATA[// 1. 当前时间在白班时间段内 (Time_Real >= Time_Set1 AND Time_Real < Time_Set2)]]>
</Line>
<Line Number="86">
<![CDATA[// 2. 设备处于运行状态 (In_Run)]]>
</Line>
<Line Number="87">
<![CDATA[// 操作: 计算白班累计值]]>
</Line>
<Line Number="88">
<![CDATA[IF (Time_Real >= Time_Set1) AND (Time_Real < Time_Set2) AND In_Run THEN]]>
</Line>
<Line Number="89">
<![CDATA[    // 首次进入白班时,记录初始值]]>
</Line>
<Line Number="90">
<![CDATA[    IF NOT Flag_Class1_Start THEN]]>
</Line>
<Line Number="91">
<![CDATA[        Temp[10] := In_Flow;]]>
</Line>
<Line Number="92">
<![CDATA[        Flag_Class1_Start := 1;]]>
</Line>
<Line Number="93">
<![CDATA[        Flag_Class2_Start := 0;]]>
</Line>
<Line Number="94">
<![CDATA[    END_IF;]]>
</Line>
<Line Number="95">
<![CDATA[    ]]>
</Line>
<Line Number="96">
<![CDATA[    // 计算白班实时累计值]]>
</Line>
<Line Number="97">
<![CDATA[    Out_Tot_Class1_RT := In_Flow - Temp[10];]]>
</Line>
<Line Number="98">
<![CDATA[END_IF;]]>
</Line>
<Line Number="99">
<![CDATA[]]>
</Line>
<Line Number="100">
<![CDATA[// 白班结束处理 - 保存累计值]]>
</Line>
<Line Number="101">
<![CDATA[// 触发条件: 到达夜班开始时间 (21:00) 且在 0-1 秒内]]>
</Line>
<Line Number="102">
<![CDATA[IF (Hour = 21) AND (Minute = 0) AND (Second <= 1) AND In_Run THEN]]>
</Line>
<Line Number="103">
<![CDATA[    Out_Tot_Class1 := In_Flow - Temp[10];]]>
</Line>
<Line Number="104">
<![CDATA[    Out_Tot_Class1_RT := 0;]]>
</Line>
<Line Number="105">
<![CDATA[    Flag_Class1_Start := 0;]]>
</Line>
<Line Number="106">
<![CDATA[END_IF;]]>
</Line>
<Line Number="107">
<![CDATA[]]>
</Line>
<Line Number="108">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="109">
<![CDATA[// 功能段 4: 夜班累计逻辑]]>
</Line>
<Line Number="110">
<![CDATA[// 执行频率: 每次扫描]]>
</Line>
<Line Number="111">
<![CDATA[// 说明: 在夜班时间段内进行累计计数]]>
</Line>
<Line Number="112">
<![CDATA[// 时间段: 21:00 - 次日 09:00]]>
</Line>
<Line Number="113">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="114">
<![CDATA[// 夜班累计计数]]>
</Line>
<Line Number="115">
<![CDATA[// 条件:]]>
</Line>
<Line Number="116">
<![CDATA[// 1. 当前时间在夜班时间段内 (Time_Real >= Time_Set2 OR Time_Real < Time_Set1)]]>
</Line>
<Line Number="117">
<![CDATA[// 2. 设备处于运行状态 (In_Run)]]>
</Line>
<Line Number="118">
<![CDATA[// 操作: 计算夜班累计值]]>
</Line>
<Line Number="119">
<![CDATA[IF ((Time_Real >= Time_Set2) OR (Time_Real < Time_Set1)) AND In_Run THEN]]>
</Line>
<Line Number="120">
<![CDATA[    // 首次进入夜班时,记录初始值]]>
</Line>
<Line Number="121">
<![CDATA[    IF NOT Flag_Class2_Start THEN]]>
</Line>
<Line Number="122">
<![CDATA[        Temp[11] := In_Flow;]]>
</Line>
<Line Number="123">
<![CDATA[        Flag_Class2_Start := 1;]]>
</Line>
<Line Number="124">
<![CDATA[        Flag_Class1_Start := 0;]]>
</Line>
<Line Number="125">
<![CDATA[    END_IF;]]>
</Line>
<Line Number="126">
<![CDATA[    ]]>
</Line>
<Line Number="127">
<![CDATA[    // 计算夜班实时累计值]]>
</Line>
<Line Number="128">
<![CDATA[    Out_Tot_Class2_RT := In_Flow - Temp[11];]]>
</Line>
<Line Number="129">
<![CDATA[END_IF;]]>
</Line>
<Line Number="130">
<![CDATA[]]>
</Line>
<Line Number="131">
<![CDATA[// 夜班结束处理 - 保存累计值]]>
</Line>
<Line Number="132">
<![CDATA[// 触发条件: 到达白班开始时间 (09:00) 且在 0-1 秒内]]>
</Line>
<Line Number="133">
<![CDATA[IF (Hour = 9) AND (Minute = 0) AND (Second <= 1) AND In_Run THEN]]>
</Line>
<Line Number="134">
<![CDATA[    Out_Tot_Class2 := In_Flow - Temp[11];]]>
</Line>
<Line Number="135">
<![CDATA[    Out_Tot_Class2_RT := 0;]]>
</Line>
<Line Number="136">
<![CDATA[    Flag_Class2_Start := 0;]]>
</Line>
<Line Number="137">
<![CDATA[END_IF;]]>
</Line>
<Line Number="138">
<![CDATA[]]>
</Line>
<Line Number="139">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="140">
<![CDATA[// 功能段 5: 3小时区间累计逻辑]]>
</Line>
<Line Number="141">
<![CDATA[// 执行频率: 每次扫描]]>
</Line>
<Line Number="142">
<![CDATA[// 说明: 每3小时区间的累计计数]]>
</Line>
<Line Number="143">
<![CDATA[// 区间: 00:00-03:00, 03:00-06:00, 06:00-09:00, 09:00-12:00]]>
</Line>
<Line Number="144">
<![CDATA[//       12:00-15:00, 15:00-18:00, 18:00-21:00, 21:00-24:00]]>
</Line>
<Line Number="145">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="146">
<![CDATA[// 3小时区间累计计数]]>
</Line>
<Line Number="147">
<![CDATA[// 条件:]]>
</Line>
<Line Number="148">
<![CDATA[// 1. 设备处于运行状态 (In_Run)]]>
</Line>
<Line Number="149">
<![CDATA[// 操作: 计算当前3小时区间的累计值]]>
</Line>
<Line Number="150">
<![CDATA[IF In_Run THEN]]>
</Line>
<Line Number="151">
<![CDATA[    // 首次进入当前3小时区间时,记录初始值]]>
</Line>
<Line Number="152">
<![CDATA[    IF Last_Hour_Index <> Hour_Index THEN]]>
</Line>
<Line Number="153">
<![CDATA[        Temp[20 + Hour_Index] := In_Flow;]]>
</Line>
<Line Number="154">
<![CDATA[        Last_Hour_Index := Hour_Index;]]>
</Line>
<Line Number="155">
<![CDATA[    END_IF;]]>
</Line>
<Line Number="156">
<![CDATA[    ]]>
</Line>
<Line Number="157">
<![CDATA[    // 计算当前3小时区间实时累计值]]>
</Line>
<Line Number="158">
<![CDATA[    Out_Tot_3H_RT := In_Flow - Temp[20 + Hour_Index];]]>
</Line>
<Line Number="159">
<![CDATA[    ]]>
</Line>
<Line Number="160">
<![CDATA[    // 保存各3小时区间的累计值]]>
</Line>
<Line Number="161">
<![CDATA[    CASE Hour_Index OF]]>
</Line>
<Line Number="162">
<![CDATA[        0: Out_Tot_3H_00_03 := In_Flow - Temp[20];]]>
</Line>
<Line Number="163">
<![CDATA[        1: Out_Tot_3H_03_06 := In_Flow - Temp[21];]]>
</Line>
<Line Number="164">
<![CDATA[        2: Out_Tot_3H_06_09 := In_Flow - Temp[22];]]>
</Line>
<Line Number="165">
<![CDATA[        3: Out_Tot_3H_09_12 := In_Flow - Temp[23];]]>
</Line>
<Line Number="166">
<![CDATA[        4: Out_Tot_3H_12_15 := In_Flow - Temp[24];]]>
</Line>
<Line Number="167">
<![CDATA[        5: Out_Tot_3H_15_18 := In_Flow - Temp[25];]]>
</Line>
<Line Number="168">
<![CDATA[        6: Out_Tot_3H_18_21 := In_Flow - Temp[26];]]>
</Line>
<Line Number="169">
<![CDATA[        7: Out_Tot_3H_21_24 := In_Flow - Temp[27];]]>
</Line>
<Line Number="170">
<![CDATA[    END_CASE;]]>
</Line>
<Line Number="171">
<![CDATA[END_IF;]]>
</Line>
<Line Number="172">
<![CDATA[]]>
</Line>
<Line Number="173">
<![CDATA[// 3小时区间结束处理 - 重置]]>
</Line>
<Line Number="174">
<![CDATA[// 触发条件: 区间切换后 2-3 秒]]>
</Line>
<Line Number="175">
<![CDATA[IF (Last_Hour_Index <> Hour_Index) AND (Second >= 2) AND (Second <= 3) THEN]]>
</Line>
<Line Number="176">
<![CDATA[    // 区间切换时,不需要清零临时变量]]>
</Line>
<Line Number="177">
<![CDATA[    // 因为 Temp[20+Hour_Index] 会在进入新区间时重新赋值]]>
</Line>
<Line Number="178">
<![CDATA[END_IF;]]>
</Line>
<Line Number="179">
<![CDATA[]]>
</Line>
<Line Number="180">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="181">
<![CDATA[// 功能段 6: 班实时累计输出]]>
</Line>
<Line Number="182">
<![CDATA[// 执行频率: 每次扫描]]>
</Line>
<Line Number="183">
<![CDATA[// 说明: 根据当前时间输出对应的班实时累计值]]>
</Line>
<Line Number="184">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="185">
<![CDATA[// 输出当前班次的实时累计值]]>
</Line>
<Line Number="186">
<![CDATA[// 条件判断:]]>
</Line>
<Line Number="187">
<![CDATA[// - 如果在白班时间段内,输出白班实时累计值]]>
</Line>
<Line Number="188">
<![CDATA[// - 否则,输出夜班实时累计值]]>
</Line>
<Line Number="189">
<![CDATA[IF (Time_Real >= Time_Set1) AND (Time_Real < Time_Set2) THEN]]>
</Line>
<Line Number="190">
<![CDATA[    Out_Tot_Class_RT := Out_Tot_Class1_RT;]]>
</Line>
<Line Number="191">
<![CDATA[ELSE]]>
</Line>
<Line Number="192">
<![CDATA[    Out_Tot_Class_RT := Out_Tot_Class2_RT;]]>
</Line>
<Line Number="193">
<![CDATA[END_IF;]]>
</Line>
<Line Number="194">
<![CDATA[]]>
</Line>
<Line Number="195">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="196">
<![CDATA[// 功能段 7: HMI 命令处理]]>
</Line>
<Line Number="197">
<![CDATA[// 执行频率: 每次扫描]]>
</Line>
<Line Number="198">
<![CDATA[// 说明: 处理 HMI 发送的控制命令]]>
</Line>
<Line Number="199">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="200">
<![CDATA[// 处理 HMI 清除命令]]>
</Line>
<Line Number="201">
<![CDATA[// 触发条件: HMI_CMD.Clear = 1 (HMI 发送清除命令)]]>
</Line>
<Line Number="202">
<![CDATA[// 操作: 清零所有累计值]]>
</Line>
<Line Number="203">
<![CDATA[IF HMI_CMD.Clear THEN]]>
</Line>
<Line Number="204">
<![CDATA[    // 清零所有输出累计值]]>
</Line>
<Line Number="205">
<![CDATA[    Out_Tot := 0;]]>
</Line>
<Line Number="206">
<![CDATA[    Out_Tot_Class_RT := 0;]]>
</Line>
<Line Number="207">
<![CDATA[    Out_Tot_Class1 := 0;]]>
</Line>
<Line Number="208">
<![CDATA[    Out_Tot_Class1_RT := 0;]]>
</Line>
<Line Number="209">
<![CDATA[    Out_Tot_Class2 := 0;]]>
</Line>
<Line Number="210">
<![CDATA[    Out_Tot_Class2_RT := 0;]]>
</Line>
<Line Number="211">
<![CDATA[    Out_Tot_3H_RT := 0;]]>
</Line>
<Line Number="212">
<![CDATA[    Out_Tot_3H_00_03 := 0;]]>
</Line>
<Line Number="213">
<![CDATA[    Out_Tot_3H_03_06 := 0;]]>
</Line>
<Line Number="214">
<![CDATA[    Out_Tot_3H_06_09 := 0;]]>
</Line>
<Line Number="215">
<![CDATA[    Out_Tot_3H_09_12 := 0;]]>
</Line>
<Line Number="216">
<![CDATA[    Out_Tot_3H_12_15 := 0;]]>
</Line>
<Line Number="217">
<![CDATA[    Out_Tot_3H_15_18 := 0;]]>
</Line>
<Line Number="218">
<![CDATA[    Out_Tot_3H_18_21 := 0;]]>
</Line>
<Line Number="219">
<![CDATA[    Out_Tot_3H_21_24 := 0;]]>
</Line>
<Line Number="220">
<![CDATA[    ]]>
</Line>
<Line Number="221">
<![CDATA[    // 清零标志位]]>
</Line>
<Line Number="222">
<![CDATA[    Flag_Class1_Start := 0;]]>
</Line>
<Line Number="223">
<![CDATA[    Flag_Class2_Start := 0;]]>
</Line>
<Line Number="224">
<![CDATA[    Last_Hour_Index := -1;]]>
</Line>
<Line Number="225">
<![CDATA[    ]]>
</Line>
<Line Number="226">
<![CDATA[    // 清零临时累计变量]]>
</Line>
<Line Number="227">
<![CDATA[    Temp[10] := 0;  // 白班初始值]]>
</Line>
<Line Number="228">
<![CDATA[    Temp[11] := 0;  // 夜班初始值]]>
</Line>
<Line Number="229">
<![CDATA[    Temp[20] := 0;  // 00:00-03:00 初始值]]>
</Line>
<Line Number="230">
<![CDATA[    Temp[21] := 0;  // 03:00-06:00 初始值]]>
</Line>
<Line Number="231">
<![CDATA[    Temp[22] := 0;  // 06:00-09:00 初始值]]>
</Line>
<Line Number="232">
<![CDATA[    Temp[23] := 0;  // 09:00-12:00 初始值]]>
</Line>
<Line Number="233">
<![CDATA[    Temp[24] := 0;  // 12:00-15:00 初始值]]>
</Line>
<Line Number="234">
<![CDATA[    Temp[25] := 0;  // 15:00-18:00 初始值]]>
</Line>
<Line Number="235">
<![CDATA[    Temp[26] := 0;  // 18:00-21:00 初始值]]>
</Line>
<Line Number="236">
<![CDATA[    Temp[27] := 0;  // 21:00-24:00 初始值]]>
</Line>
<Line Number="237">
<![CDATA[    ]]>
</Line>
<Line Number="238">
<![CDATA[    // 清零 HMI 清除命令位 (防止重复执行)]]>
</Line>
<Line Number="239">
<![CDATA[    HMI_CMD.Clear := 0;]]>
</Line>
<Line Number="240">
<![CDATA[END_IF;]]>
</Line>
<Line Number="241">
<![CDATA[]]>
</Line>
<Line Number="242">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="243">
<![CDATA[// 功能段 8: HMI 数据同步]]>
</Line>
<Line Number="244">
<![CDATA[// 执行频率: 每次扫描]]>
</Line>
<Line Number="245">
<![CDATA[// 说明: 将累计值同步到 HMI 命令块]]>
</Line>
<Line Number="246">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="247">
<![CDATA[// 同步累计值到 HMI 命令块]]>
</Line>
<Line Number="248">
<![CDATA[HMI_CMD.Out_Tot := Out_Tot;]]>
</Line>
<Line Number="249">
<![CDATA[HMI_CMD.Out_Tot_Class_RT := Out_Tot_Class_RT;]]>
</Line>
<Line Number="250">
<![CDATA[HMI_CMD.Out_Tot_Class1 := Out_Tot_Class1;]]>
</Line>
<Line Number="251">
<![CDATA[HMI_CMD.Out_Tot_Class2 := Out_Tot_Class2;]]>
</Line>
<Line Number="252">
<![CDATA[HMI_CMD.Out_Tot_3H_RT := Out_Tot_3H_RT;]]>
</Line>
<Line Number="253">
<![CDATA[HMI_CMD.Out_Tot_3H_00_03 := Out_Tot_3H_00_03;]]>
</Line>
<Line Number="254">
<![CDATA[HMI_CMD.Out_Tot_3H_03_06 := Out_Tot_3H_03_06;]]>
</Line>
<Line Number="255">
<![CDATA[HMI_CMD.Out_Tot_3H_06_09 := Out_Tot_3H_06_09;]]>
</Line>
<Line Number="256">
<![CDATA[HMI_CMD.Out_Tot_3H_09_12 := Out_Tot_3H_09_12;]]>
</Line>
<Line Number="257">
<![CDATA[HMI_CMD.Out_Tot_3H_12_15 := Out_Tot_3H_12_15;]]>
</Line>
<Line Number="258">
<![CDATA[HMI_CMD.Out_Tot_3H_15_18 := Out_Tot_3H_15_18;]]>
</Line>
<Line Number="259">
<![CDATA[HMI_CMD.Out_Tot_3H_18_21 := Out_Tot_3H_18_21;]]>
</Line>
<Line Number="260">
<![CDATA[HMI_CMD.Out_Tot_3H_21_24 := Out_Tot_3H_21_24;]]>
</Line>
<Line Number="261">
<![CDATA[]]>
</Line>
<Line Number="262">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="263">
<![CDATA[// 功能段 9: 启用状态输出]]>
</Line>
<Line Number="264">
<![CDATA[// 执行频率: 每次扫描]]>
</Line>
<Line Number="265">
<![CDATA[// 说明: 设置 AOI 的启用状态输出]]>
</Line>
<Line Number="266">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="267">
<![CDATA[// 设置 AOI 启用状态输出]]>
</Line>
<Line Number="268">
<![CDATA[EnableOut := EnableIn;]]>
</Line>
<Line Number="269">
<![CDATA[]]>
</Line>
<Line Number="270">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="271">
<![CDATA[// 程序结束]]>
</Line>
<Line Number="272">
<![CDATA[// ===============================================================]]>
</Line>
<Line Number="273">
<![CDATA[// 总结:]]>
</Line>
<Line Number="274">
<![CDATA[// 本程序实现了一个完整的多维度流量计累计量统计系统,具有以下特点:]]>
</Line>
<Line Number="275">
<![CDATA[// 1. 支持 3 个时间维度的累计 (总/班/3小时区间)]]>
</Line>
<Line Number="276">
<![CDATA[// 2. 自动切换累计维度,无需人工干预]]>
</Line>
<Line Number="277">
<![CDATA[// 3. 实时累计与历史累计分离,数据安全可靠]]>
</Line>
<Line Number="278">
<![CDATA[// 4. 支持 HMI 交互,可手动清除累计值]]>
</Line>
<Line Number="279">
<![CDATA[// 5. 代码结构清晰,注释详细,易于维护和扩展]]>
</Line>
<Line Number="280">
<![CDATA[// ===============================================================]]>
</Line>
</STContent>
</Routine>
</Routines>
</Program>
</Programs>
</Controller>
</RSLogix5000Content>
